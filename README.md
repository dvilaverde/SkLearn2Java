# SkLearn2Java

This project aims to used text exported ML models generated by sci-kit learn and make them usable in Java.

For example, a DecisionTreeClassifier model trained on the Iris dataset and exported using `sklearn.tree`
export_text() as shown below:

```
>>> from sklearn.datasets import load_iris
>>> from sklearn.tree import DecisionTreeClassifier
>>> from sklearn.tree import export_text
>>> iris = load_iris()
>>> X = iris['data']
>>> y = iris['target']
>>> decision_tree = DecisionTreeClassifier(random_state=0, max_depth=2)
>>> decision_tree = decision_tree.fit(X, y)
>>> r = export_text(decision_tree, feature_names=iris['feature_names'])
>>> print(r)

|--- petal width (cm) <= 0.80
|   |--- class: 0
|--- petal width (cm) >  0.80
|   |--- petal width (cm) <= 1.75
|   |   |--- class: 1
|   |--- petal width (cm) >  1.75
|   |   |--- class: 2
```

can be executed in Java using 

```
    Reader tree = getTrainedModel("iris.model");
    final Classifier<Integer> decisionTree = DecisionTreeClassifier.parse(tree,
                new PredictionFactory.IntegerPredictionFactory());

    Map<String, Double> features = new HashMap<>();
    features.put("sepal length (cm)", 3.0);
    features.put("sepal width (cm)", 5.0);
    features.put("petal length (cm)", 4.0);
    features.put("petal width (cm)", 2.0);
    
    Integer prediction = decisionTree.predict(features);
    System.out.println(prediction.toString());
```

## Support
* The tree.DecisionTreeClassifier is supported
  * Supports `predict()`, 
  * Supports `predict_proba()` when `export_text()` configured with `show_weights=True` 

## Testing
Testing was done using sci-kit learn 1.1.3.
